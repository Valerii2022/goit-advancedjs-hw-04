{"version":3,"file":"commonHelpers.js","sources":["../src/pixabay-API.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst KEY = '34628461-4bda2ae404146a46c3fd3a186';\n\nconst baseSearchParams = {\n  key: KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\n\nexport const fetchImages = async (q, page) => {\n  try {\n    const { data } = await axios.get(`${BASE_URL}`, {\n      params: { ...baseSearchParams, q, page },\n    });\n    return data;\n  } catch (error) {\n    iziToast.error({\n      message: `${error.message}`,\n      layout: 2,\n      position: 'topLeft',\n      transitionIn: 'fadeInRight',\n      transitionOut: 'fadeOutLeft',\n    });\n    throw new Error(error);\n  }\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './pixabay-API';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('.input'),\n  searchBtn: document.querySelector('.search-btn'),\n  list: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  sentinel: document.querySelector('.sentinel'),\n};\n\nlet page = 1;\nlet query = '';\nlet uploadedImages = 0;\nlet totalImages = 0;\nlet modalLightbox;\n\nrefs.form.addEventListener('submit', handleSeachBtnClick);\n\nfunction handleSeachBtnClick(e) {\n  e.preventDefault();\n  refs.loader.classList.remove('hidden');\n  if (!e.currentTarget.searchQuery.value.trim()) {\n    iziToast.error({\n      message: `Sorry, your search query is empty. Please try again.`,\n      layout: 2,\n      position: 'topLeft',\n      transitionIn: 'fadeInRight',\n      transitionOut: 'fadeOutLeft',\n    });\n    refs.loader.classList.add('hidden');\n    return;\n  }\n  page = 1;\n  query = '';\n  uploadedImages = 0;\n  totalImages = 0;\n  fetchImages(e.currentTarget.searchQuery.value.trim(), page)\n    .then(data => {\n      onSuccess(data);\n    })\n    .catch(err => {\n      refs.loader.classList.add('hidden');\n      console.log(err);\n    });\n  query = e.currentTarget.searchQuery.value.trim();\n  e.currentTarget.reset();\n}\n\nfunction onSuccess(data) {\n  refs.loader.classList.add('hidden');\n  if (!data.totalHits) {\n    iziToast.error({\n      message: `Sorry, there are no images matching your search query. Please try again.`,\n      layout: 2,\n      position: 'topLeft',\n      transitionIn: 'fadeInRight',\n      transitionOut: 'fadeOutLeft',\n    });\n    return;\n  }\n  page += 1;\n  totalImages = data.totalHits;\n  uploadedImages += data.hits.length;\n  iziToast.success({\n    message: `Hooray! We found ${data.totalHits} images.`,\n    layout: 2,\n    position: 'topLeft',\n    transitionIn: 'fadeInRight',\n    transitionOut: 'fadeOutLeft',\n  });\n  refs.list.innerHTML = markup(data);\n  modalLightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n  });\n  modalLightbox.refresh();\n}\n\nfunction markup({ hits }) {\n  const result = hits\n    .map(el => {\n      return `<a class=\"link\" href=${el.largeImageURL} id=${el.id}><div class=\"photo-card\" >\n    <div class=\"img-wrap\"><img src=${el.webformatURL} alt=${el.tags} loading=\"lazy\" /></div>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>\n            <span>${el.likes}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Views</b>\n            <span>${el.views}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            <span>${el.comments}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            <span>${el.downloads}</span>\n        </p>\n    </div>\n</div></a>`;\n    })\n    .join('');\n  return result;\n}\n\nfunction loadMoreImages() {\n  modalLightbox.destroy();\n  fetchImages(query, page)\n    .then(data => {\n      refs.list.insertAdjacentHTML('beforeend', markup(data));\n      page += 1;\n      uploadedImages += data.hits.length;\n      modalLightbox = new SimpleLightbox('.gallery a', {\n        captionDelay: 250,\n      });\n      modalLightbox.refresh();\n    })\n    .catch(err => {\n      iziToast.error({\n        message: `Something went wrong. Please try again!`,\n        layout: 2,\n        position: 'topLeft',\n        transitionIn: 'fadeInRight',\n        transitionOut: 'fadeOutLeft',\n      });\n      console.log(err);\n    });\n}\n\nconst intersectionObserve = entries => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting && query !== '' && uploadedImages < totalImages) {\n      loadMoreImages();\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(intersectionObserve, {\n  rootMargin: '200px',\n});\n\nobserver.observe(refs.sentinel);\n"],"names":["BASE_URL","KEY","baseSearchParams","fetchImages","q","page","data","axios","error","iziToast","refs","query","uploadedImages","totalImages","modalLightbox","handleSeachBtnClick","onSuccess","err","markup","SimpleLightbox","hits","el","loadMoreImages","intersectionObserve","entries","entry","observer"],"mappings":"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"}